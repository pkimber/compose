{% extends 'dash/base.html' %}

{% load thumbnail %}

{% block sub_title %}
  Link Library
{% endblock sub_title %}

{% block sub_heading %}
  Link Library
{% endblock sub_heading %}

{% block content %}
  <div class="row">
    <div class="col">

        <ul class="nav flex-column">
          {% include 'base/_back_to_settings.html' %}
          <li class="nav-item">
            <a href="{% url 'block.link.category.list' %}" class="nav-link">
              <i class="fa fa-picture-o"></i>
              Link Categories
            </a>
          </li>
          <li class="nav-item">
             <a href="{% url 'block.link.document.create' %}" class="nav-link">
              <i class="fa fa-file-o"></i>
              Upload New Document
            </a>
          </li>
        </ul>

    </div>
  </div>
  <div class="row">
      <div class="col">
        <strong>Title:</strong>
      </div>
      <div class="col">
        <strong>Target:</strong>
      </div>
      <div class="col">
        <strong>Permanent Url *:</strong>
      </div>
      <div class="col">
        <strong>Pages used:</strong>
      </div>
  </div>
  {% for link in link_list %}
    {% ifchanged link.category %}
    <div class="row">
      <div class="col">
        <h3>
          {% if link.category %}
            {{ link.category.name }}
          {% else %}
            No Category
          {% endif %}
        </h3>
      </div>
    </div>
    {% endifchanged %}
    <div class="row">
      <div class="col">
        <a href="{% if link.is_document %}{% url 'block.link.document.update' link.pk %}{% elif link.is_external %}{% url 'block.link.external.update' link.pk %}{% elif link.is_internal %}{% url 'block.link.internal.update' link.pk %}{% endif %}">
          <i class="fa fa-edit"></i> {{ link.title }}
        </a>
      </div>
      <div class="col">
        {% if link.is_document %}
          <strong>Document:</strong> {{ link.file_name }}
        {% elif link.is_internal %}
        <strong>Page:</strong> {{ link.url }}
        {% elif link.is_external %}
        <strong>Url:</strong> {{ link.url }}
        {% endif %}
      </div>
      <div class="col">
        {% url 'block.link.follow' link.link_type link.pk %}
      </div>
      <div class="col">
        {% for page in link.pages_used %}
          {% if forloop.counter0 %}, {% endif %}
          {{ page }}
        {% empty %}
          <a href="{% url 'block.link.delete' link.pk %}">
            <i class="fa fa-trash-o"></i>
          </a>
        {% endfor %}
      </div>
    </div>
  {% endfor %}
  <div>
    <p>* If using a link in the text of an article, use the Permanent Url rather than the Target.  </p>
  </div>
{% endblock content %}
